# アプリケーション仕様

## 概要
このツールは、Backlog(https://backlog.com/ja/)のプロジェクトに含まれるリポジトリに含まれる、あるプルリクエストに対してつけられたすべてのコメントを取得し、Excelに出力することができる。

## 詳細
- BacklogはAPIでアクセスする
- BacklogのAPIについての仕様は https://developer.nulab.com/docs/backlog/ を参照する
- BacklogのAPI呼び出しに必要な認証については https://developer.nulab.com/docs/backlog/auth/ の 'API Key'の仕組みを利用する
- 'API Key'は、.envファイルより取得するものとし、リポジトリ管理されないようにする
- Backlogの情報は、下記のような包含関係にあり、それぞれAPIでのアクセスが可能である
  - スペース
    - プロジェクト
      - リポジトリ
        - プルリクエスト
          - コメント
- スペースについては、.envファイルより取得するものとし、リポジトリ管理されないようにする
- API Keyとスペースから、プロジェクトを取得し、ユーザに選択肢を示したうえで数値で選択可能とする
- 選択されたプロジェクトに含まれるリポジトリを取得し、ユーザに選択肢を示したうえで数値で選択可能とする
- 選択されたリポジトリに含まれるプルリクエストを取得し、ユーザに選択肢を示したうえで数値で選択可能とする
- 選択されたプルリクエストに対して存在するすべてのコメントについて下記の情報を取得する
  - コメントがつけられた場所（ただしこの情報は存在しない場合もある。その場合は'全体'を場所とする）
  - createdUser -> name
  - createdDate（ただし、yyyy/mm/ddまででよい）
  - コメント内容
- 取得した情報をExcelファイルに出力する
  - 出力するExcelファイルのファイル名は'プロジェクト名_リポジトリ名_プルリクエスト名_yyyymmdd.xlsx'とする

### 環境変数名について
API KEYに対する環境変数名：BACKLOG_API_KEY

Backlogのスペースに対する環境変数名：BACKLOG_SPACE

環境変数BACKLOG_SPACEの具体的な形式は、ドメインの部分のみである。

## ユーザインタフェース
CLIアプリケーションとして実装する

## エラーハンドリング
### API呼び出しエラー
エラーメッセージをCLI上に表示してアプリケーションを終了する。
このとき、エラー内容がユーザーが認識できるようなメッセージを出力すること。

### レート制限
下記のドキュメントに沿って実装する
https://developer.nulab.com/docs/backlog/rate-limit/

## 多言語対応
多言語対応は不要

## Excelのフォーマット
下記の４列をもつものとする

- コメントがつけられた場所（ただしこの情報は存在しない場合もある。その場合は'全体'を場所とする）
- createdUser -> name
- createdDate（ただし、yyyy/mm/ddまででよい）
- コメント内容

## 利用するライブラリ
Excelの出力に利用するライブラリは何でもよい

## アプリケーションの実行環境
Windows11 64bit 版で動作すればOK